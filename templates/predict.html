<!DOCTYPE html>
<html>

<head>
    <title>Health Chat üè•</title>
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
</head>

<body class="bg-light">

    <div class="container mt-5">

        <h2 class="mb-4">Talk to Health AI üß†</h2>

        <!-- CHAT WINDOW -->
        <div id="chatBox" class="card mb-3 shadow-sm"
            style="height: 350px; overflow-y: auto; background-color:#36373a;">

            <!-- created id for chatBox -->
            <script>
                // scroll to bottom automatically
                const chatBox = document.getElementById("chatBox");
                chatBox.scrollTop = chatBox.scrollHeight;
            </script>

            <div class="card-body">

                {% for msg in chat %}

                {% if msg.role == "user" %}
                <div class="text-end mb-2">
                    <div class="text-end mb-2">
                        <span class="bg-primary text-white p-3 rounded-4 shadow-sm d-inline-block"
                            style="max-width: 70%; word-break: break-word;">
                            <small class="d-block fw-bold">You</small>
                            {{ msg.text }}
                        </span>

                    </div>

                    <!-- word-break means horizontally scrolling in chat bubble -->
                </div>


                {% else %}
                <div class="text-start mb-2">
                    <div class="text-start mb-2">
                        <span class="bg-success text-white p-3 rounded-4 shadow-sm d-inline-block"
                            style="max-width: 70%; word-break: break-word;">
                            <small class="d-block fw-bold">Health AI</small>
                            {{ msg.text }}
                        </span>

                    </div>


                </div>
                {% endif %}

                {% endfor %}

            </div>
        </div>


        <div id="typing" class="text-start mb-2" style="display:none;">
            <span class="bg-secondary text-white p-2 rounded-4 shadow-sm d-inline-block">
                Analysing....
            </span>
        </div>


        <!-- INPUT BOX -->
        <form method="POST" id="chatForm">
            <div class="input-group">
                <input name="message" id="messageInput" class="form-control rounded-pill"
                    placeholder="Type your symptoms...">

                <button class="btn btn-primary rounded-pill px-4">Send</button>

            </div>
        </form>

    </div>
    <script>
        var form = document.getElementById("chatForm");
        var typing = document.getElementById("typing");

        form.addEventListener("submit", function (e) {
            e.preventDefault();          // ruk ja, abhi submit mat ho
            typing.style.display = "block";

            setTimeout(function () {
                form.submit();           // ab submit kar
            }, 2000);                     // 2 sec delay
        });
    </script>

</body>

</html>